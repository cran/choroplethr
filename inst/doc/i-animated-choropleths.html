<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Animated Choropleths</title>
<style type="text/css">
/**
 * Prism.s theme ported from highlight.js's xcode style
 */
pre code {
  padding: 1em;
}
.token.comment {
  color: #007400;
}
.token.punctuation {
  color: #999;
}
.token.tag,
.token.selector {
  color: #aa0d91;
}
.token.boolean,
.token.number,
.token.constant,
.token.symbol {
  color: #1c00cf;
}
.token.property,
.token.attr-name,
.token.string,
.token.char,
.token.builtin {
  color: #c41a16;
}
.token.inserted {
  background-color: #ccffd8;
}
.token.deleted {
  background-color: #ffebe9;
}
.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
  color: #9a6e3a;
}
.token.atrule,
.token.attr-value,
.token.keyword {
  color: #836c28;
}
.token.function,
.token.class-name {
  color: #DD4A68;
}
.token.regex,
.token.important,
.token.variable {
  color: #5c2699;
}
.token.important,
.token.bold {
  font-weight: bold;
}
.token.italic {
  font-style: italic;
}
</style>
<style type="text/css">
body {
  font-family: sans-serif;
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 1.5;
  box-sizing: border-box;
}
body, .footnotes, code { font-size: .9em; }
li li { font-size: .95em; }
*, *:before, *:after {
  box-sizing: inherit;
}
pre, img { max-width: 100%; }
pre, pre:hover {
  white-space: pre-wrap;
  word-break: break-all;
}
pre code {
  display: block;
  overflow-x: auto;
}
code { font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace; }
:not(pre) > code, code[class] { background-color: #F8F8F8; }
code.language-undefined, pre > code:not([class]) {
  background-color: inherit;
  border: 1px solid #eee;
}
table {
  margin: auto;
  border-top: 1px solid #666;
}
table thead th { border-bottom: 1px solid #ddd; }
th, td { padding: 5px; }
thead, tfoot, tr:nth-child(even) { background: #eee; }
blockquote {
  color: #666;
  margin: 0;
  padding-left: 1em;
  border-left: 0.5em solid #eee;
}
hr, .footnotes::before { border: 1px dashed #ddd; }
.frontmatter { text-align: center; }
#TOC .numbered li { list-style: none; }
#TOC .numbered { padding-left: 0; }
#TOC .numbered ul { padding-left: 1em; }
table, .body h2 { border-bottom: 1px solid #666; }
.body .appendix, .appendix ~ h2 { border-bottom-style: dashed; }
.footnote-ref a::before { content: "["; }
.footnote-ref a::after { content: "]"; }
.footnotes::before {
  content: "";
  display: block;
  max-width: 20em;
}

@media print {
  body {
    font-size: 12pt;
    max-width: 100%;
  }
  tr, img { page-break-inside: avoid; }
}
@media only screen and (min-width: 992px) {
  pre { white-space: pre; }
}
</style>
</head>
<body>
<div class="include-before">
</div>
<div class="frontmatter">
<div class="title"><h1>Animated Choropleths</h1></div>
<div class="author"><h2></h2></div>
<div class="date"><h3></h3></div>
</div>
<div class="body">
<!--
  %\VignetteEngine{knitr}
%\VignetteIndexEntry{i) Animated Choropleths}
-->
<h1 id="animated-choropleths">Animated Choropleths</h1>
<p>Animated choropleths are a useful way to understand how regional values change over time.  Consider the US Presidential Election choropleth: it is normally used to show how each state voted in the last presidential election.  But what if you want to understand how the results of last election compare to the previous election? Or the election before?  In this case an animated choropleth is an effective tool to understand the data.</p>
<h3 id="example-historical-us-presidential-election-results">Example: Historical US Presidential Election Results</h3>
<p>choroplethr ships with an example dataset of all US Presidential Election returns. This data is in the variable <code>df_president_ts</code>.</p>
<pre><code class="language-r">library(choroplethr)

?df_president_ts
data(df_president_ts)

head(df_president_ts, n=1)
</code></pre>
<pre><code>##    region 1789 1792 1796 1800 1804 1808 1812 1816 1820    1824 1828 1832 1836
## 1 alabama &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;   DR Jackson    D    D    D
##   1840 1844 1848 1852 1856 1860 1864 1868 1872 1876 1880 1884 1888 1892 1896
## 1    D    D    D    D    D   SD &lt;NA&gt;    R    R    D    D    D    D    D    D
##   1900 1904 1908 1912 1916 1920 1924 1928 1932 1936 1940 1944 1948 1952 1956
## 1    D    D    D    D    D    D    D    D    D    D    D    D   SR    D    D
##   1960 1964 1968 1972 1976 1980 1984 1988 1992 1996 2000 2004 2008 2012
## 1    I    R   AI    R    D    R    R    R    R    R    R    R    R    R
</code></pre>
<h3 id="animating-the-data">Animating the data</h3>
<p>To animate this data.frame use the <code>choroplethr_animate</code> function (?choroplethr_animate).  It has one argument, a list of choropleths.  Our first task, then, is to convert <code>df_president_ts</code> into a list of choropleths:</p>
<pre><code># create a list of choropleths of presidential election results for each year
choropleths = list()
for (i in 2:ncol(df_president_ts)) {
  df           = df_president_ts[, c(1, i)]
  colnames(df) = c(&quot;region&quot;, &quot;value&quot;)
  title        = paste0(&quot;Presidential Election Results: &quot;, colnames(df_president_ts)[i])
  choropleths[[i-1]] = state_choropleth(df, title=title)
}
</code></pre>
<p>Then call choroplethr_animate with the list of choropleths:</p>
<pre><code>choroplethr_animate(choropleths)
</code></pre>
<h3 id="output">Output</h3>
<p>choroplethr_animate will write each choropleth to your current working directory with the naming convention <code>choropleth_1.png</code>, <code>choropleth_2.png</code>, etc.  It will then write an HTML file named <code>animated_choropleth.html</code>.  Open that file with a browser - it contains a JavaScript based player that allows you to cycle thru all the images.</p>
<p>Here is a screenshot of the player.  Note that in the upper right hand corner are <em>play</em> and <em>stop</em> buttons.  Clicking them will play or stop the animation.  There are also <em>+</em> and <em>-</em> buttons which allow you to cycle thru the animation at your own speed.</p>
<p><img src="https://raw.githubusercontent.com/trulia/choroplethr/10e5e8447c24ef4ca8494eaa35ece8585e091993/wiki-images/animation-screenshot.png" alt="choroplethr_animate screenshot" /></p>
</div>
<div class="include-after">
</div>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js" defer></script>
</body>
</html>
